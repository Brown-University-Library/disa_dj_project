{% extends "disa_app_templates/redesign_base.html" %}


<!-- Just a note that we could have page-specific sidebar documentation here, if desired. -->

{% block sidebar %}
{% endblock sidebar %}


<!-- The content-block html below is within the redesign_base.html template's `<main class="container">` element. -->

{% block content %}


<!-- PATRICK STYLES -->

<style>



</style>


<!-- JavaScript-savvy URL control to toggle div display between #startpanel above & #tabs_bibinfoanditems below -->
<div id="tabs_bibinfoanditems" style="margin-top:10em;">
    <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a  class="nav-link active" href="#Bibliographic-information" 
                data-toggle="tab" role="tab" 
                aria-controls="Bibliographic-information" aria-expanded="true">
                Bibliographic information
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="#Items" data-toggle="tab" role="tab" aria-controls="Items" aria-expanded="true">Items</a>
        </li>
    </ul>
    <div class="tab-content">
        <div class="active tab-pane" style="padding: 20px;" role="tabpanel" aria-labelledby="Bibliographic-information" id="Bibliographic-information">
            <span   class="badge badge-primary float-right" 
                    title="Unique identifier for this citation">
                    ID {{ doc.id }}
            </span>
            <h5 class="text-dark" style="width:25%;float:left;">Citation type:</h5>
            <div style="clear: left;">

                <!-- CITATION TYPE DROPDOWN SELECTOR -->

                <!-- <label for="formInputDISADocType" style="padding-left:12%;">Citation type:</label> -->

                <!-- hardcoded -->
                <!-- Ben, I'm going to soon comment-out the select style block below.
                    Just a note that the (dynamic) replacement code below uses a different id.
                    I _could_ change it to match `formInputDISADocType`, but would have to change it in
                    5 or so places in the javascript at the bottom of this page.
                    If your styling depends on the `formInputDISADocType`, I'll go ahead and change it.
                    (I like the explicitness of your id name.)
                    Eventually I'm going to rename it anyway, working to unify 'doc' references to 'cite' or 'citation' references.
                    -->
                
                <!--

                <select style="width:75%;float:right;" class="custom-select" id="formInputDISADocType">
                    <option selected>Newspaper Article</option>
                    <option value="1">[Other doc format]</option>
                    <option value="2">[Other doc format]</option>
                    <option value="3">[Other doc format]</option>
                </select>

                -->

                <!-- dynamic -->
                <!-- populated by js readDocumentData() -> initializeForm() -->
                <!-- <select class="form-control" id="document_type"> -->

                <select style="" class="custom-select" id="document_type">
                    <!-- (Patrick) This option is only to be shown if citation type has not been selected -->
                    <option value="0" class="initMessage">
                        [Select a document type]
                    </option> 
                </select>
            </div>

            <!-- CITATION FIELDS (REQUIRED, OPTIONAL, AND HIDDEN) -->

            <h5 id="required-fields-header" hidden>Priority information</h5>
            <div id="required-fields"></div>
            <h5 id="optional-fields-header" hidden>Additional information</h5>
            <div id="optional-fields"></div>
            <div id="hidden-fields" hidden>
                <div class="citation-field form-group text-dark" id="abstractNote">
                <label for="abstractNote-value" style="padding-left:15%;">Abstract Note:</label>
                <input id="abstractNote-value" name="abstractNote-value" />
                </div>
                <div class="citation-field form-group text-dark" id="accessDate">
                <label for="accessDate-value" style="padding-left:15%;">Access Date:</label>
                <input id="accessDate-value" name="accessDate-value" />
                </div>
                <div class="citation-field form-group text-dark" id="archive">
                <label for="archive-value" style="padding-left:15%;">Archive:</label>
                <input id="archive-value" name="archive-value" />
                </div>
                <div class="citation-field form-group text-dark" id="archiveLocation">
                <label for="archiveLocation-value" style="padding-left:15%;">Archive Location:</label>
                <input id="archiveLocation-value" name="archiveLocation-value" />
                </div>
                <div class="citation-field form-group text-dark" id="author">
                <label for="author-value" style="padding-left:15%;">Author:</label>
                <input id="author-value" name="author-value" />
                </div>
                <div class="citation-field form-group text-dark" id="callNumber">
                <label for="callNumber-value" style="padding-left:15%;">Call Number:</label>
                <input id="callNumber-value" name="callNumber-value" />
                </div>
                <div class="citation-field form-group text-dark" id="date">
                <label for="date-value" style="padding-left:15%;">Date:</label>
                <input id="date-value" name="date-value" />
                </div>
                <div class="citation-field form-group text-dark" id="edition">
                <label for="edition-value" style="padding-left:15%;">Edition:</label>
                <input id="edition-value" name="edition-value" />
                </div>
                <div class="citation-field form-group text-dark" id="extra">
                <label for="extra-value" style="padding-left:15%;">Extra:</label>
                <input id="extra-value" name="extra-value" />
                </div>
                <div class="citation-field form-group text-dark" id="ISBN">
                <label for="ISBN-value" style="padding-left:15%;">ISBN:</label>
                <input id="ISBN-value" name="ISBN-value" />
                </div>
                <div class="citation-field form-group text-dark" id="ISSN">
                <label for="ISSN-value" style="padding-left:15%;">ISSN:</label>
                <input id="ISSN-value" name="ISSN-value" />
                </div>
                <div class="citation-field form-group text-dark" id="language">
                <label for="language-value" style="padding-left:15%;">Language:</label>
                <input id="language-value" name="language-value" />
                </div>
                <div class="citation-field form-group text-dark" id="libraryCatalog">
                <label for="libraryCatalog-value" style="padding-left:15%;">Library Catalog:</label>
                <input id="libraryCatalog-value" name="libraryCatalog-value" />
                </div>
                <div class="citation-field form-group text-dark" id="pages">
                <label for="pages-value" style="padding-left:15%;">Pages:</label>
                <input id="pages-value" name="pages-value" />
                </div>
                <div class="citation-field form-group text-dark" id="place">
                <label for="place-value" style="padding-left:15%;">Place:</label>
                <input id="place-value" name="place-value" />
                </div>
                <div class="citation-field form-group text-dark" id="publicationTitle">
                <label for="publicationTitle-value" style="padding-left:15%;">Publication Title:</label>
                <input id="publicationTitle-value" name="publicationTitle-value" />
                </div>
                <div class="citation-field form-group text-dark" id="rights">
                <label for="rights-value" style="padding-left:15%;">Rights:</label>
                <input id="rights-value" name="rights-value" />
                </div>
                <div class="citation-field form-group text-dark" id="section">
                <label for="section-value" style="padding-left:15%;">Section:</label>
                <input id="section-value" name="section-value" />
                </div>
                <div class="citation-field form-group text-dark" id="series">
                <label for="series-value" style="padding-left:15%;">Series:</label>
                <input id="series-value" name="series-value" />
                </div>
                <div class="citation-field form-group text-dark" id="seriesNumber">
                <label for="seriesNumber-value" style="padding-left:15%;">Series Number:</label>
                <input id="seriesNumber-value" name="seriesNumber-value" />
                </div>
                <div class="citation-field form-group text-dark" id="shortTitle">
                <label for="shortTitle-value" style="padding-left:15%;">Short Title:</label>
                <input id="shortTitle-value" name="shortTitle-value" />
                </div>
                <div class="citation-field form-group text-dark" id="title">
                <label for="title-value" style="padding-left:15%;">Title:</label>
                <input id="title-value" name="title-value" />
                </div>
                <div class="citation-field form-group text-dark" id="url">
                <label for="url-value" style="padding-left:15%;">URL:</label>
                <input id="url-value" name="url-value" />
                </div>
            </div>
            <!--
            <div class="form-group text-dark">
                <label for="formInputDISATitle" style="padding-left:10%;">Title<span style="font-size:85%;" class="text-danger">(required)</span></label>
                <input style="width:75%;float:right;" type="text" class="form-control" id="formInputDISATitle" placeholder="Enter Title">
            </div>
            <div class="form-group text-dark">
                <label for="formInputDISAPlace" style="padding-left:15%;">Place</label>
                <input style="width:75%;float:right;" type="text" class="form-control" id="formInputDISAPlace" placeholder="Enter Place">
            </div>
            <label for="formInputDISABiblioDateYear" style="padding-left:15%;">Date</label>
            <div style="width:75%;float:right;">
                <p style="width:25%;float:left;padding-right:10px;"> <select class="custom-select" id="formInputDISABiblioDateYear">
                        <option selected>Year</option>
                        <option value="1">[Year values?]</option>
                        <option value="2">[Year values?]</option>
                        <option value="3">[Year values?]</option>
                    </select>
                </p>
                <p style="width:25%;float:left;padding-right:10px;"> <select class="custom-select" id="formInputDISABiblioDateMonth">
                        <option selected>Month</option>
                        <option value="1">[Month values?]</option>
                        <option value="2">[Month values?]</option>
                        <option value="3">[Month values?]</option>
                    </select>
                </p>
                <p style="width:25%;float:left;padding-right:0px;"> <select class="custom-select" id="formInputDISABiblioDateDay">
                        <option selected>[Day]</option>
                        <option value="1">[Day values?]</option>
                        <option value="2">[Day values?]</option>
                        <option value="3">[Day values?]</option>
                    </select>
                </p>
            </div>
            -->

            <!--
            <div class="form-group text-dark">
                <label for="formInputDISAFieldA" style="padding-left:15%;">Field A</label>
                <input style="width:75%;float:right;" type="text" class="form-control" id="formInputDISAFieldA" placeholder="[Placeholder text]">
            </div>
            <div class="form-group text-dark">
                <label for="formInputDISAFieldB" style="padding-left:15%;">Field B</label>
                <input style="width:75%;float:right;" type="text" class="form-control" id="formInputDISAFieldB" placeholder="[Placeholder text]">
            </div> -->

            <div class="form-group">
                <label for="formInputDISAAcknowledgements" style="padding-left:0%;">Acknowledgements</label>
                <textarea style="width:75%;float:right;" class="form-control" rows="3" id="formInputDISAAcknowledgements"></textarea>
            </div>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <div class="form-group" style="clear:both;">
                <label for="formInputDISABiblioResearcherNotes" style="padding-left:0%;">Researcher notes
                    <br>
                    <span style="font-size:85%;"><a href="#">Report problems or ask for help</a></span>
                </label>
                <textarea style="width:75%;float:right;" class="form-control" rows="3" id="formInputDISABiblioResearcherNotes"></textarea>
            </div>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <button type="button" class="btn btn-primary btn-md" style="font-weight: bold;">SAVE AND CONTINUE TO ENTER ITEMS</button>
        </div> <!-- /.tab-pane for bibinfo -->
        <div class="tab-pane" role="tabpanel" aria-labelledby="Items" id="Items">
            <div style="padding: 0px; padding-top: 0px;">
                <ul class="nav nav-tabs" role="tablist" style="padding: 20px;">
                    <li class="nav-item">
                        <a class="nav-link" href="#New-Item" data-toggle="tab" role="tab" aria-controls="New-Item" aria-expanded="true">New Item</a>
                    </li>
                    <!-- hide Discuss tab
                    <li class="nav-item">
                        <a class="nav-link" href="#tab4" data-toggle="tab" role="tab" aria-controls="tab4" aria-expanded="true">Discuss</a>
                    </li>
                    <li class="nav-item"></li>
                    <li class="nav-item"></li>
                    -->
                    <li style="font-weight: bold;padding-left: 25px;padding-top: 9px;" class="text-success">All changes saved</li>
                </ul>
                <div class="tab-content" style="background-color: white!important;opacity:1;">
                    <div class="active tab-pane" role="tabpanel" aria-labelledby="New-Item" id="New-Item" style="margin-top:-20px;padding-top:0px;">
                        <div class="row col-lg-12" style="padding-top:40px;">
                            <div class="col-md-6">
                                <h5 class="text-dark" style="float:left;margin-left:20px;">Location in source citation</h5>
                                <p>&nbsp;</p>
                                <div class="form-group text-dark">
                                    <label for="formInputDISAItemVolume" style="padding-left:15%;">Volume</label>
                                    <input style="width:60%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAItemVolume" placeholder="Volume #">
                                </div>
                                <p></p>
                                <div class="form-group text-dark">
                                    <label for="formInputDISASourcePageStart" style="padding-left:15%;">Page number, from</label>
                                    <input style="width:40%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISASourcePageStart" placeholder="start pg. #">
                                    <p></p>
                                    <label for="formInputDISASourcePageEnd" style="padding-left:43%;clear:left;">to</label>
                                    <input style="width:40%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISASourcePageEnd" placeholder="end pg. #">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5 class="text-dark" style="float:left;margin-left: 20px;">Item content</h5>
                                <p>&nbsp;</p>
                                <div class="form-group text-dark">
                                    <label for="formInputDISAItemType" style="padding-left:5%;">Item type:</label>
                                    <select style="width:70%;float:right;" class="custom-select" id="formInputDISAItemType">
                                        <option selected>Select an item type...</option>
                                        <option value="1">One</option>
                                        <option value="2">Two</option>
                                        <option value="3">Three</option>
                                    </select>
                                </div>
                                <div style="text-align:left;">
                                    <div class="form-group" style="margin-top:20px;">
                                        <label for="formInputDISAItemTranscription" style="padding-left:5%;float:left;">Transcription</label>
                                        <br>
                                        <a href="#" style="margin-left:0%;font-size:80%;margin-top:-7px;clear:left;float:left;">Open in new window</a>
                                        <textarea style="margin-top:-25px;margin-bottom:20px;width:70%;float:right;" class="form-control" rows="3" id="formInputDISAItemTranscription"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div> <!-- /.row -->
                        <hr>
                        <div class="row" style="padding-top:20px;padding-right:20px;">
                            <div class="col-md-6">
                                <h5 class="text-dark" style="float:left;margin-left:40px;">Event date</h5>
                                <p>&nbsp;</p>
                                <div class="form-group text-dark">
                                    <label for="formInputDISAEventDateMonth" style="padding-left:10%;">Month</label>
                                    <select style="width:60%;float:right;margin-right:5%;" class="custom-select" id="formInputDISAEventDateMonth">
                                        <option selected>Unspecified</option>
                                        <option value="1">Unspecified 1</option>
                                        <option value="2">Unspecified 2</option>
                                        <option value="3">Unspecified 3</option>
                                    </select>
                                </div>
                                <div class="form-group text-dark">
                                    <label for="formInputDISAEventDateDay" style="padding-left:10%;">Day</label>
                                    <select style="width:60%;float:right;margin-right:5%;" class="custom-select" id="formInputDISAEventDateDay">
                                        <option selected>Unspecified</option>
                                        <option value="1">Unspecified 1</option>
                                        <option value="2">Unspecified 2</option>
                                        <option value="3">Unspecified 3</option>
                                    </select>
                                </div>
                                <div class="form-group text-dark">
                                    <label for="formInputDISAEventDateYear" style="padding-left:10%;">Year</label>
                                    <select style="width:60%;float:right;margin-right:5%;" class="custom-select" id="formInputDISAEventDateYear">
                                        <option selected>Unspecified</option>
                                        <option value="1">Unspecified 1</option>
                                        <option value="2">Unspecified 2</option>
                                        <option value="3">Unspecified 3</option>
                                    </select>
                                </div>
                                <div class="form-group text-dark">
                                    <label for="formInputDISAEventDateInfo" style="padding-left:10%;">Additional date info</label>
                                    <input style="width:50%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAEventDateInfo" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5 class="text-dark" style="float:left;margin-left: 20px;">Place</h5>
                                <p>&nbsp;</p>
                                <div class="form-group text-dark">
                                    <label for="formInputDISAColonialContext" style="padding-left:5%;">Colonial context</label>
                                    <select style="width:60%;float:right;margin-right:5%;" class="custom-select" id="formInputDISAColonialContext">
                                        <option selected>[context option]</option>
                                        <option value="1">[context option 1]</option>
                                        <option value="2">[context option 2]</option>
                                        <option value="3">[context option 3]</option>
                                    </select>
                                </div>
                                <div class="form-group text-dark">
                                    <label for="formInputDISAColonyState" style="padding-left:5%;">Colony/State</label>
                                    <input style="width:60%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAColonyState" placeholder="">
                                </div>
                                <div class="form-group text-dark">
                                    <label for="formInputDISATown" style="padding-left:5%;">Town</label>
                                    <input style="width:60%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISATown" placeholder="">
                                </div>
                                <div class="form-group text-dark">
                                    <label for="formInputDISAPlaceInfo" style="padding-left:5%;">Additional location info</label>
                                    <input style="width:50%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAPlaceInfo" placeholder="">
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="row" style="padding-top:20px;padding-right:20px;">
                            <div class="col-md-12" style="margin-left: 40px;">
                                <h5 class="text-dark" style="float:left;">People</h5>
                                <a href="#" class="text-primary" style="padding-left: 25px;font-size: 107%;">ADD PERSON</a>
                                <p>&nbsp;</p>
                                <p></p>
                            </div>
                        </div>
                        <div class="col-lg-12" style="padding: 40px;padding-top: 0px">
                            <div class="card">
                                <div class="card-header">
                                    <a href="#">NEW PERSON</a>
                                </div>
                                <div class="card-body">
                                    <div style="padding-left:20px;padding-top:20px;width:auto;position: relative;">
                                        <div>
                                            Name(s)
                                        </div>
                                    </div>
                                    <div style="float:right;width:87%;margin-bottom: 0;padding-bottom: 0;">
                                        <div style="padding: 20px;clear:none;margin-top:-20px;border:1px;border-color:LightGray;border-style: solid;clear: none;position: relative;margin-right:40px;">
                                            <div class="form-group text-dark">
                                                <div class="custom-control custom-switch" style="clear: none;float:right;padding-top: 5px;">
                                                    <input type="checkbox" class="custom-control-input" id="formCustomSwitchForAdvancedNames">
                                                    <label style="font-size: 85%;padding-top: 2px;" class="custom-control-label" for="formCustomSwitchForAdvancedNames">Advanced name options</label>
                                                </div>
                                                <label for="formInputDISAItemPersonNameType" style="padding-left:0%;">Name type</label>
                                                <select style="width:42%;float:right;margin-right:5%;" class="custom-select" id="formInputDISAItemPersonNameType">
                                                    <option selected>[context option]</option>
                                                    <option value="1">[context option 1]</option>
                                                    <option value="2">[context option 2]</option>
                                                    <option value="3">[context option 3]</option>
                                                </select>
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAItemPersonNameTranscription" style="padding-left:0%;">Full name transcription</label>
                                                <input style="width:70%;float:right;" type="text" class="form-control" id="formInputDISAItemPersonNameTranscription" placeholder="">
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAItemPersonFirstName" style="padding-left:0%;">First name</label>
                                                <input style="width:75%;float:right;" type="text" class="form-control" id="formInputDISAItemPersonFirstName" placeholder="">
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAItemPersonLastName" style="padding-left:0%;">Last name</label>
                                                <input style="width:75%;float:right;" type="text" class="form-control" id="formInputDISAItemPersonLastName" placeholder="">
                                            </div>
                                        </div>
                                        <p style="clear:both;float:left;padding-top: 10px;"><i class="fas fa-plus-circle text-primary"></i>&nbsp;<a href="#" class="text-primary">ADD ANOTHER NAME</a></p>
                                    </div>
                                    <div class="row" style="padding-top:0px;padding-right:20px;clear: both;">
                                        <div class="col-md-6" style="margin-left: 0px;">
                                            <!-- <h5 class="text-dark" style="float:left;"></h5> -->
                                            <p>&nbsp;</p>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAPersonGender" style="padding-left:5%;">Gender</label>
                                                <select style="width:60%;float:right;margin-right:5%;" class="custom-select" id="formInputDISAPersonGender">
                                                    <option selected>&nbsp;</option>
                                                    <option value="1">&nbsp;</option>
                                                    <option value="2">&nbsp;</option>
                                                    <option value="3">&nbsp;</option>
                                                </select>
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAPersonAge_number" style="padding-left:5%;">Age</label>
                                                <select style="width:auto;float:right;margin-right:5%;clear: left;" class="custom-select" id="formInputDISAPersonAge_number">
                                                    <option selected>&nbsp;</option>
                                                    <option value="-1">Unspecified</option>
                                                    <option value="1">1 year</option>
                                                    <option value="2">2 years</option>
                                                    <option value="3">3 years</option>
                                                </select>
                                                <input style="width:60%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAPersonAge_text" placeholder="">
                                                <div class="form-check" style="float:right;clear:none;margin-right:10%;padding-left: 10%;">
                                                    <input class="form-check-input" type="checkbox" id="formInputSpecifiedByNumber" value="option1">
                                                    <label style="font-size: 85%;margin-top: -6px;" class="form-check-label" for="formInputSpecifiedByNumber">SPECIFIED BY A NUMBER</label>
                                                </div>
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAPersonStatus" style="padding-left:5%;">Status</label>
                                                <select style="width:60%;float:right;margin-right:5%;" class="custom-select" id="formInputDISAPersonStatus">
                                                    <option selected>&nbsp;</option>
                                                    <option value="1">&nbsp;</option>
                                                    <option value="2">&nbsp;</option>
                                                    <option value="3">&nbsp;</option>
                                                </select>
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAStatusInfo" style="padding-left:5%;font-size:82%;">Additional status information</label>
                                                <input style="width:50%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAStatusInfo" placeholder="">
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAPersonVocation" style="padding-left:5%;">Vocation</label>
                                                <input style="width:60%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAPersonVocation" placeholder="">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <!-- <h5 class="text-dark" style="float:left;margin-left: 20px;"></h5> -->
                                            <p>&nbsp;</p>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAPersonRace" style="padding-left:5%;">Race</label>
                                                <select style="width:60%;float:right;margin-right:5%;" class="custom-select" id="formInputDISAPersonRace">
                                                    <option selected>&nbsp;</option>
                                                    <option value="1">&nbsp;</option>
                                                    <option value="2">&nbsp;</option>
                                                    <option value="3">&nbsp;</option>
                                                </select>
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAPersonRaceTerms" style="padding-left:5%;">Exact racial terms used</label>
                                                <input style="width:40%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAPersonRaceTerms" placeholder="">
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAPersonTribe" style="padding-left:5%;">Tribe</label>
                                                <select style="width:60%;float:right;margin-right:5%;" class="custom-select" id="formInputDISAPersonTribe">
                                                    <option selected>&nbsp;</option>
                                                    <option value="1">&nbsp;</option>
                                                    <option value="2">&nbsp;</option>
                                                    <option value="3">&nbsp;</option>
                                                </select>
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAPersonTribeTerms" style="padding-left:5%;font-size:77%;">Exact identity/geographical terms used</label>
                                                <input style="width:40%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAPersonTribeTerms" placeholder="">
                                            </div>
                                            <div class="form-group text-dark">
                                                <label for="formInputDISAPersonGeoOrigins" style="padding-left:5%;">Geographic origins</label>
                                                <input style="width:50%;float:right;margin-right:5%;" type="text" class="form-control" id="formInputDISAPersonGeoOrigins" placeholder="">
                                            </div>
                                        </div>
                                    </div>
                                </div>  <!-- /.card-body for a new person -->
                            </div>
                        </div>
                        <div class="col-lg-12" style="padding-top:0px;padding:40px;">
                            <div class="form-group" style="margin-top:-30px;">
                                <label for="formInputDISAPeopleResearcherNotes">Researcher notes</label>
                                <a href="#" style="font-size:80%;margin-top:-7px;padding-left: 25px;clear: none;">Report problems or ask for help</a>
                                <textarea class="form-control" rows="3" id="formInputDISAPeopleResearcherNotes"></textarea>
                            </div>
                            <button type="button" class="btn btn-secondary btn-md" style="font-weight: bold;margin-top: 20px;">ALL CHANGES SAVED</button>
                            <button type="button" class="btn btn-primary btn-md" style="font-weight: bold;margin-top: 20px;margin-left: 15px;">SAVE ITEM AND EXIT THIS SOURCE CITATION</button>
                        </div>
                    </div> <!-- /.tab-pane for items -->
                </div> <!-- /.tab-content for items -->
            </div>
        </div>
    </div>
</div> <!-- /#tabs_bibinfoanditems -->

{% endblock content %}


{% block page_specific_js %}

<script type="text/javascript">

    var getDocumentId = function () {
        {# var doc_id = "{{ doc.id or '' }}"; #}
        var doc_id = "{{ doc.id }}";
        console.log( "in getDocumentId; doc_id, ", doc_id );
        return doc_id;
    }

    var makeCitationFieldInput = function(fieldData) {
        var $input, $row, $label;
        $row = $('<li/>', {
            'class' : 'citation-field',
            'style' : `order: ${fieldData.rank}` });
        $input = $('<input/>', {
            'id' : fieldData.name,
            'class' : 'form-control',
            'type' : 'text',
            'placeholder': fieldData.display,
            'data-citation-field': fieldData.name });
        $input.val(fieldData.value);
        $row.append($input);

        return $row;
    }

    var updateCitationFields = function(citeData, citeType, ctMap) {
        var ct_fields = ctMap[citeType];
        $fg = $('#citation_fields');
        $('#citation_fields').siblings('label').show();
        $fg.empty();
        for (var i=0; i < ct_fields.length; i++) {
            var field_data = ct_fields[i];
            if (field_data.name in citeData) {
                field_data['value'] = citeData[field_data.name];
            } else {
                field_data['value'] = '';
            }
            $fg.append(makeCitationFieldInput(field_data));
        }
    }

    var collectCitationFieldData = function(dataObj) {
        var cite_fields = $('.citation-field');
        dataObj['fields'] = {};
        cite_fields.each( function(index) {
            $input = $(this).find('input');
            dataObj.fields[$input.attr('data-citation-field')] = $input.val();
        })
        return dataObj
    }

    var setInputValues = function(docData) {
        if ( $.isEmptyObject(docData) ) {
            return;
        }
        $('#citation').text(docData['citation']);
        // $('#zotero').val(docData['zotero_id']);
        $('#document_type').val(docData['citation_type_id']).attr('selected', true);
        $('#comments').text(docData['comments']);
        $('#acknowledgements').text(docData['acknowledgements']);
    }

    var collectInputValues = function() {
        var data = {};
        // data['zotero_id'] = $('#zotero').val();
        data['citation_type_id'] = Number($('#document_type').val());
        data['comments'] = $('#comments').val();
        data['acknowledgements'] = $('#acknowledgements').val();
        data = collectCitationFieldData(data);
        return data;
    }

    var addTypeOptions = function(opts) {
        var dtype_select = $('#document_type');
        // dtype_select.empty();
        for (var i = 0; i < opts.length; i++) {
            var opt = opts[i];
            var opt_elem = $("<option/>", { 'value': opt.id ,
                                            'text': opt.name });
            dtype_select.append(opt_elem);
        }
        dtype_select.val(null);
    }

    var setFormHeader = function (docData) {
        var header = $('#document_header');
        console.log( "in setFormHeader; header, ", header );
        if ( $.isEmptyObject(docData) ) {
            header.text('Add a document');
            header.append(`<div style="font-size: 50%"><em>Fill out this form only when entering a document for the first time.
                If your document has been already entered, find your document in the
                <a href="/editor">recent document list</a> and add an item.</em></div>`);
            $('#doc_update').text('Create');
            $('#citation_fields').siblings('label').hide();
        } else {
            header.text(docData['citation']);
        }
    }

    var initializeForm = function (data, ctMap) {
        console.log( "starting initializeForm()" );
        setFormHeader(data['doc']);
        addTypeOptions(data['doc_types']);
        setInputValues(data['doc']);
        if ( 'fields' in data['doc'] ) {
            updateCitationFields(
                data['doc']['fields'], data['doc']['citation_type_id'], ctMap);
        }
    }

    var readDocumentData = function(docId, ctMap, copy) {
        console.log( "starting readDocumentData()" );
        if (copy) {
            var doc_data_api = "{% url 'data_documents_url' 'copy' %}";
            console.log( 'in readDocumentData; doc_data_api for `copy`, ', doc_data_api );
        } else if(docId) {
            var doc_data_api = "{% url 'data_documents_url' 'STUB' %}".replace( "STUB", docId );
            console.log( 'in readDocumentData; doc_data_api with `docId`, ', doc_data_api );
        } else {
            var doc_data_api = "{% url 'data_documents_url' %}";
            console.log( 'in readDocumentData; doc_data_api with NO `docId`, ', doc_data_api );
        }
        console.log( "in readDocumentData; docId, ", docId );
        console.log( "in readDocumentData; copy, ", copy );
        $.get(doc_data_api, function(data) {
            initializeForm(data, ctMap);
        });
    }

    var updateDocumentData = function(docId, ctMap) {
        {# var doc_data_api = "{% url 'update_citation_data' None %}" + docId; #}
        if (docId) {
            var doc_data_api = "{% url 'data_documents_url' 'STUB' %}".replace( "STUB", docId);
            console.log( 'in updateDocumentData; doc_data_api with `docId`, ', doc_data_api );
        } else {
            var doc_data_api = "{% url 'data_documents_url' %}";
            console.log( 'in updateDocumentData; doc_data_api with NO `docId`, ', doc_data_api );
        }
        var data = collectInputValues();
        var method = (docId ? "PUT" : "POST");
        $.ajax({
            type: method,
            url: doc_data_api,
            contentType: "application/json",
            data: JSON.stringify(data),
            success: function(data) {
                if ( method === 'POST' ) {
                    window.location.href = data.redirect;
                } else {
                    initializeForm(data, ctMap);
                    $('#document_form').accordion('option','active', false );
                }
            }
        });
    }

    var activateReferenceDelete = function($delBtn) {
      var $cancel_btn = $('<button/>', {
        'class': 'btn btn-secondary deactivate-delete',
        'title': 'Cancel current changes'
      });
      var $cancel_span = $('<span/>', {'class': 'fas fa-undo'});
      $cancel_btn.append($cancel_span);
      $delBtn.empty().text('Confirm delete').addClass('active');
      $delBtn.before($cancel_btn);
      return true;
    }

    var deactivateReferenceDelete = function($cancelBtn) {
      var $del_span = $('<span/>', {'class': 'fas fa-times-circle'});
      var $del_btn = $cancelBtn.next('.del-reference');
      $cancelBtn.remove();
      $del_btn.empty().append($del_span).removeClass('active');
      return true;
    }

    var deleteReference = function($refRow, ctMap) {
        var ref_del_api = "{% url 'data_reference_url' 'STUB' %}"
            .replace('STUB', $refRow.attr('data-reference'));
        console.log( 'in deleteReference; ref_del_api, ', ref_del_api );
        $.ajax({
            type: "DELETE",
            url: ref_del_api,
            success: function(data) {
              window.location.href = data.redirect;
            }
        });
    }

    var deleteDocument = function( doc_id ) {
        /*  This only passes the doc_id; think about passing more identifying info
            ...so the server doesn't have to do a lookup for more document info. */
        console.log( "in `var deleteDocument`; `doc_id`, ", doc_id );
        var doc_data_api_root = "{% url 'data_documents_url' %}";
        var full_doc_data_api = doc_data_api_root + doc_id + "/";
        $.ajax({
            type: "DELETE",
            url: full_doc_data_api,
            success: function(data) {
              // setTimeout( () => {console.log("waiting two seconds");}, 5000 );
              console.log( 'in deleteDocument; data, ', data );
              window.location.href = data.redirect;
              // alert( "Citation " + doc_id + " marked for deletion." );
            }
        });
        console.log( "ajax call done" );
    }

    $( document ).ready(function() {
        var doc_id = getDocumentId();
        console.log( "in document.ready(); doc_id, ", doc_id );
        //
        var cite_type_fields = JSON.parse( '{{ ct_fields_json | safe }}' );
        console.log( "in document.ready(); cite_type_fields, ", cite_type_fields );

        console.log( "in document.ready(); about to call readDocumentData()" );
        readDocumentData(doc_id, cite_type_fields, false);
        console.log( "in document.ready(); called readDocumentData()" );
        //
        // var documents_url = "{{ documents_url }}";
        var documents_url = "{% url 'editor_index_url' %}";
        console.log( "in document.ready(); documents_url, ", documents_url );
        //
        $( "#document_form" ).accordion({
            collapsible: true,
            header: "h2",
            heightStyle: "content",
            active: (doc_id ? false : 0)
        });
        $( "#document_date" ).datepicker({
          changeMonth: true,
          changeYear: true,
          yearRange: "1492:1900"
        });
        $( "#document_type").on('change', function(e) {
            e.preventDefault();
            var cite_type = $(this).val();
            var cite_data = collectCitationFieldData({});
            updateCitationFields(
                cite_data['fields'], cite_type, cite_type_fields);
        });
        $( "#references_table" ).on('click', '.del-reference:not(.active)', function(e) {
          e.preventDefault();
          activateReferenceDelete($(this));
        });
        $( "#references_table" ).on('click', '.deactivate-delete', function(e) {
          e.preventDefault();
          deactivateReferenceDelete($(this));
        });
        $( "#references_table" ).on('click', '.del-reference.active', function(e) {
          e.preventDefault();
          var $ref_row = $(this).closest('tr');
          deleteReference($ref_row, cite_type_fields);
        });
        $( "#doc_update" ).on('click', function(e) {
          e.preventDefault();
          updateDocumentData(doc_id, cite_type_fields);
        });
        $( "#copy_previous" ).on('click', function(e) {
          e.preventDefault();
          $(this).parent().remove();
          readDocumentData(doc_id, cite_type_fields, true);
        });


        {% if can_delete_doc %}

            $( "#confirm-delete-button" ).on('click', function(e) {
              e.preventDefault();
              deleteDocument(doc_id);
              // alert( "put deletion code here." );
              window.location.replace( documents_url );
            });

        {% endif %}

    } );  // end of `$( document ).ready(function() {`


    // PATRICK'S CODE STARTS HERE

    // Data structure for showing / hiding citation fields

    const fieldsByDocType = {
        20: {
          required: ["author", "date", "pages", "place", "title"],
          optional: [
            "abstractNote",
            "edition",
            "language",
            "series",
            "seriesNumber",
            "shortTitle",
            "url"
          ]
        },
        21: {
          required: ["author", "date", "pages", "place", "title"],
          optional: [
            "abstractNote",
            "edition",
            "language",
            "section",
            "series",
            "seriesNumber",
            "shortTitle",
            "url"
          ]
        },
        26: {
          required: ["author", "date", "pages", "place", "title"],
          optional: [
            "abstractNote",
            "archive",
            "archiveLocation",
            "language",
            "url"
          ]
        },
        33: {
          required: ["author", "date", "place", "rights", "title"],
          optional: [
            "abstractNote",
            "archive",
            "archiveLocation",
            "language",
            "url"
          ]
        },
        34: {
          required: ["author", "date", "pages", "title"],
          optional: ["abstractNote", "language", "url"]
        },
        36: {
          required: ["author", "date", "pages", "title"],
          optional: ["abstractNote", "language", "url"]
        },
        37: {
          required: [
            "archive",
            "archiveLocation",
            "author",
            "date",
            "pages",
            "title"
          ],
          optional: ["abstractNote", "language", "place", "url"]
        },
        39: {
          required: ["date", "edition", "place", "title"],
          optional: [
            "abstractNote",
            "archive",
            "archiveLocation",
            "author",
            "language",
            "pages",
            "section",
            "url"
          ]
        },
        46: {
          required: ["author", "date", "rights", "title"],
          optional: [
            "abstractNote",
            "archive",
            "archiveLocation",
            "language",
            "url"
          ]
        },
        47: {
          required: ["date", "pages", "place", "rights", "title"],
          optional: ["abstractNote", "language", "url"]
        },
        49: {
          required: ["accessDate", "date", "title", "url"],
          optional: ["author", "language"]
        }
      };

      // On load ...

      document.addEventListener('DOMContentLoaded', () => {

        const   requiredFieldsContainer = document.getElementById('required-fields'),
                requiredFieldsHeader = document.getElementById('required-fields-header'),
                optionalFieldsContainer = document.getElementById('optional-fields'),
                optionalFieldsHeader = document.getElementById('optional-fields-header'),
                hiddenFieldsContainer = document.getElementById('hidden-fields'),
                citationTypeSelector = document.getElementById('document_type'),
                citationFields = Array.from(document.getElementsByClassName('citation-field'));

        // Called when the citation type dropdown changes

        function updateCitationFieldVisibility() {

            const citationTypeId = parseInt(this.value);

            citationFields.forEach(citationField => {
                const fieldStatus = fieldsByDocType[citationTypeId];
                citationFields.forEach(citationField => {
                    const citationFieldId = citationField.id;
                    if (fieldStatus.required.includes(citationFieldId)) {
                        requiredFieldsContainer.appendChild(citationField);
                    } else if (fieldStatus.optional.includes(citationFieldId)) {
                        optionalFieldsContainer.appendChild(citationField);
                    } else {
                        hiddenFieldsContainer.appendChild(citationField);
                    }
                });
            });

            requiredFieldsHeader.removeAttribute('hidden');
            optionalFieldsHeader.removeAttribute('hidden');
        }

        // Listeners for citation type dropdown selector

        citationTypeSelector.addEventListener(
            'change', updateCitationFieldVisibility
        );

        // Initialize display based on current citation type selection

        updateCitationFieldVisibility();

      })  

    // PATRICK'S CODE ENDS HERE


</script>

{% endblock page_specific_js %}
