{% extends "disa_app_templates/redesign_base.html" %}
{% load staticfiles %}

{% block header_other %}

<!-- Styles -->

<link rel="stylesheet" type="text/css" href="{% static 'css/redesign_citation.css' %}">
<link rel="stylesheet" href="{% static 'css/tagify.css' %}"></link>

<style>

  .disa-id-badge {
    font-size: 12px;
  }

  .disa-id-badge {
    cursor: pointer;
  }

  #save-status {
    position: fixed;
    left: 10px;
    bottom: 10px;
  }

  #item-selector-modal .modal-body li {
    cursor: pointer;
  }

  .disa-tags-input {
    display: inline-block;
  }

  #save-status.bg-success {
    -webkit-animation: heartbeat 1.5s ease-in-out both;
            animation: heartbeat 1.5s ease-in-out both;
  }

  /* ----------------------------------------------
 * Generated by Animista on 2021-5-13 16:43:25
 * Licensed under FreeBSD License.
 * See http://animista.net/license for more info. 
 * w: http://animista.net, t: @cssanimista
 * ---------------------------------------------- */

/**
 * ----------------------------------------
 * animation heartbeat
 * ----------------------------------------
 */

@-webkit-keyframes heartbeat {
  from {
    -webkit-transform: scale(1);
            transform: scale(1);
    -webkit-transform-origin: center center;
            transform-origin: center center;
    -webkit-animation-timing-function: ease-out;
            animation-timing-function: ease-out;
  }
  10% {
    -webkit-transform: scale(0.91);
            transform: scale(0.91);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
  }
  17% {
    -webkit-transform: scale(0.98);
            transform: scale(0.98);
    -webkit-animation-timing-function: ease-out;
            animation-timing-function: ease-out;
  }
  33% {
    -webkit-transform: scale(0.87);
            transform: scale(0.87);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
  }
  45% {
    -webkit-transform: scale(1);
            transform: scale(1);
    -webkit-animation-timing-function: ease-out;
            animation-timing-function: ease-out;
  }
}
@keyframes heartbeat {
  from {
    -webkit-transform: scale(1);
            transform: scale(1);
    -webkit-transform-origin: center center;
            transform-origin: center center;
    -webkit-animation-timing-function: ease-out;
            animation-timing-function: ease-out;
  }
  10% {
    -webkit-transform: scale(0.91);
            transform: scale(0.91);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
  }
  17% {
    -webkit-transform: scale(0.98);
            transform: scale(0.98);
    -webkit-animation-timing-function: ease-out;
            animation-timing-function: ease-out;
  }
  33% {
    -webkit-transform: scale(0.87);
            transform: scale(0.87);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
  }
  45% {
    -webkit-transform: scale(1);
            transform: scale(1);
    -webkit-animation-timing-function: ease-out;
            animation-timing-function: ease-out;
  }
}


</style>

<!-- Scripts -->

<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<!-- Production version of Vue: <script src="https://cdn.jsdelivr.net/npm/vue@2"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.1/umd/popper.min.js" integrity="sha512-g2PN+aYR0KupTVwea5Ppqw4bxWLLypWdd+h7E0ydT8zF+/Y2Qpk8Y1SnzVw6ZCVJPrgB/91s3VfhVhP7Y4+ucw==" crossorigin="anonymous"></script>
<script src="{% static 'js/tagify.min.js' %}" type="module"></script>
<script src="{% static 'js/entry_form_citation.js' %}" type="module"></script>

<script type="text/javascript">
    var data_itemrecord_api_url_root = "{{ data_itemrecord_api_url_root }}",  // needed by `redesign_data.js`
        TOKEN = "{{ csrf_token }}";
</script>

{% endblock header_other %}

<!-- Just a note that we could have page-specific sidebar documentation here, if desired. -->

{% block sidebar %}
{% endblock sidebar %}

<!-- The content-block html below is within the redesign_base.html template's `<main class="container">` element. -->

{% block content %}

<!-- JavaScript-savvy URL control to toggle div display between
     #startpanel above & #tabs_bibinfoanditems below -->

<!-- MAIN NAV TABS -->

<div id="tabs_bibinfoanditems" style="margin-top:10em;">
  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active"
              id="bib-tab"
              data-bs-toggle="tab"
              data-bs-target="#Bibliographic-information"
              type="button" role="tab" aria-controls="Bibliographic-information"
              aria-selected="true">
        Bibliographic information
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link"
              id="item-tab"
              data-bs-toggle="tab"
              data-bs-target="#Items"
              type="button" role="tab" aria-controls="Items"
              aria-selected="false">
        Items
      </button>
    </li>
  </ul>

  <!-- TAB CONTENT -->

  <div class="tab-content">

    <!-- Citation Tab -->

    <div class="tab-pane show active" style="padding: 20px;"
         role="tabpanel" aria-labelledby="bib-tab"
         id="Bibliographic-information">

      <form id="citation-form"
            v-on:submit.prevent="onSubmitForm">
        <span class="badge badge-secondary float-right disa-id-badge"
          title="Unique identifier for this citation">
          {{ doc.id }}
        </span>
        <h5 class="text-dark" style="width:25%;float:left;">
          Citation type
        </h5>
        <div style="clear: left;margin-bottom: 36px;">
          <select class="custom-select" id="document_type"
                  v-model="formData.doc.citation_type_id">
            <!-- If unselected, show this at the top -->
            <option value="0" class="initMessage"
                    v-if="!formData.doc.citation_type_id">
              Select a document type:
            </option>
            <option v-for="(docTypeName, docTypeId) in MENU_OPTIONS.document_type"
                    v-bind:value="docTypeId"
                    v-text="docTypeName">
            </option>
          </select>
  </div>

  <div id="citation-fields"
       style="display:flex; flex-direction:column">

    <!-- HEADERS: Priority vs Optional -->

    <h5 id="required-fields-header" style="order:100;" hidden>
      Priority information
    </h5>
    <h5 id="optional-fields-header" style="order:200;margin-top: 24px;" hidden>
      Additional information
    </h5>

    <!-- FIELDS: Dynamically moved under headings via flexbox order property -->

    <div class="citation-field form-floating" id="abstractNote">
      <input type="text" class="form-control" id="abstractNote-value" aria-label="Abstract Note" placeholder="Abstract Note" v-model="formData.doc.fields.abstractNote">
      <label for="abstractNote-value">Abstract Note</label>
    </div>

    <div class="citation-field form-floating" id="accessDate">
      <input type="text" class="form-control" id="accessDate-value" name="accessDate-value" aria-label="Access Date" placeholder="Access Date" v-model="formData.doc.fields.accessDate">
      <label for="accessDate-value">Access Date</label>
    </div>

    <div class="citation-field form-floating" id="archive">
      <input type="text" class="form-control" id="archive-value" name="archive-value" aria-label="Archive" placeholder="Archive" v-model="formData.doc.fields.archive">
      <label for="archive-value">Archive</label>
    </div>

    <div class="citation-field form-floating" id="archiveLocation">
      <input type="text" class="form-control" id="archiveLocation-value" name="archiveLocation-value" aria-label="Archive Location" placeholder="Archive Location" v-model="formData.doc.fields.archiveLocation">
      <label for="archiveLocation-value">Archive Location</label>
    </div>

    <div class="citation-field form-floating" id="author">
      <input type="text" class="form-control" id="author-value" name="author-value" aria-label="Author" placeholder="Author (last name comes first)" v-model="formData.doc.fields.author">
      <label for="author-value">Author</label>
    </div>

    <div class="citation-field form-floating" id="callNumber">
      <input type="text" class="form-control" id="callNumber-value" name="callNumber-value" aria-label="Call Number" placeholder="Call Number" v-model="formData.doc.fields.callNumber">
      <label for="callNumber-value">Call Number</label>
    </div>

    <div class="citation-field form-group text-dark"
      id="date">
      <label for="date-value"
        style="padding-right:12px;">Date</label>
      <input id="date-value" name="date-value" placeholder="Date"
             type="date"
             v-model="formData.doc.fields.date" />

      <!-- Broken out with year/month/day for when we have the new DB model -->
      <!--
      <label for="date-year-value">Year
        <input id="date-year-value" name="date-year-value" type="number"
                v-model="formData.doc.citation_type_fields['date-year']" />
      </label>
      <label for="date-month-value">Month
        <select id="date-month-value" name="date-month-value"
                v-model="formData.doc.citation_type_fields['date-month']">
          <option value="0">Not specified</option>
          <option value="1">January</option>
          <option value="2">February</option>
          <option value="3">March</option>
          <option value="4">April</option>
          <option value="5">May</option>
          <option value="6">June</option>
          <option value="7">July</option>
          <option value="8">August</option>
          <option value="9">September</option>
          <option value="10">October</option>
          <option value="11">November</option>
          <option value="12">December</option>
        </select>
      </label>
      <label for="date-day-value">Day
        <select id="date-day-value" name="date-day-value"
                v-model="formData.doc.citation_type_fields['date-day']">
          <option	value="0">	Not specified	</option>
          <option	value="1">	1	</option>
          <option	value="2">	2	</option>
          <option	value="3">	3	</option>
          <option	value="4">	4	</option>
          <option	value="5">	5	</option>
          <option	value="6">	6	</option>
          <option	value="7">	7	</option>
          <option	value="8">	8	</option>
          <option	value="9">	9	</option>
          <option	value="10">	10	</option>
          <option	value="11">	11	</option>
          <option	value="12">	12	</option>
          <option	value="13">	13	</option>
          <option	value="14">	14	</option>
          <option	value="15">	15	</option>
          <option	value="16">	16	</option>
          <option	value="17">	17	</option>
          <option	value="18">	18	</option>
          <option	value="19">	19	</option>
          <option	value="20">	20	</option>
          <option	value="21">	21	</option>
          <option	value="22">	22	</option>
          <option	value="23">	23	</option>
          <option	value="24">	24	</option>
          <option	value="25">	25	</option>
          <option	value="26">	26	</option>
          <option	value="27">	27	</option>
          <option	value="28">	28	</option>
          <option	value="29">	29	</option>
          <option	value="30">	30	</option>
          <option	value="31">	31	</option>
        </select>
      </label>
    -->
    </div>

    <div class="citation-field form-floating" id="edition">
      <input type="text" class="form-control" id="edition-value" name="edition-value" aria-label="Edition" placeholder="Edition" v-model="formData.doc.fields.edition">
      <label for="edition-value">Edition</label>
    </div>

    <div class="citation-field form-floating" id="extra">
      <input type="text" class="form-control" id="extra-value" name="extra-value" aria-label="Extra" placeholder="Extra" v-model="formData.doc.fields.extra">
      <label for="extra-value">Extra</label>
    </div>

    <div class="citation-field form-floating" id="ISBN">
      <input type="text" class="form-control" id="ISBN-value" name="ISBN-value" aria-label="ISBN" placeholder="ISBN" v-model="formData.doc.fields.ISBN">
      <label for="ISBN-value">ISBN</label>
    </div>

    <div class="citation-field form-floating" id="ISSN">
      <input type="text" class="form-control" id="ISSN-value" name="ISSN-value" aria-label="ISSN" placeholder="ISSN" v-model="formData.doc.fields.ISSN">
      <label for="ISSN-value">ISSN</label>
    </div>

    <div class="citation-field form-floating" id="language">
      <!-- @todo SHOULD BE A DROPDOWN? -->
      <input type="text" class="form-control" id="language-value" name="language-value" aria-label="Language" placeholder="Language" v-model="formData.doc.fields.language">
      <label for="language-value">Language</label>
    </div>

    <div class="citation-field form-floating" id="libraryCatalog">
      <input type="text" class="form-control" id="libraryCatalog-value" name="libraryCatalog-value" aria-label="Library Catalog" placeholder="Library Catalog" v-model="formData.doc.fields.libraryCatalog">
      <label for="libraryCatalog-value">Library Catalog</label>
    </div>

    <div class="citation-field form-floating" id="pages">
      <input type="text" class="form-control" id="pages-value" name="pages-value" aria-label="Pages" placeholder="Pages" v-model="formData.doc.fields.pages">
      <label for="pages-value">Pages</label>
    </div>

    <div class="citation-field form-floating" id="place">
      <input type="text" class="form-control" id="place-value" name="place-value" aria-label="Place" placeholder="Place" v-model="formData.doc.fields.place">
      <label for="place-value">Place</label>
    </div>

    <div class="citation-field form-floating" id="publicationTitle">
      <input type="text" class="form-control" id="publicationTitle-value" name="publicationTitle-value" aria-label="Publication Title" placeholder="Publication Title" v-model="formData.doc.fields.publicationTitle">
      <label for="publicationTitle-value">Publication Title</label>
    </div>

    <div class="citation-field form-floating" id="publisher">
      <input type="text" class="form-control" id="publisher-value"
             name="publisher-value" aria-label="Publisher"
             placeholder="Publisher"
             v-model="formData.doc.fields.publisher">
      <label for="publisher-value">Publisher</label>
    </div>

    <div class="citation-field form-floating" id="rights">
      <!-- @todo DROPDOWN? -->
      <input type="text" class="form-control" id="rights-value" name="rights-value" aria-label="Rights" placeholder="Rights" v-model="formData.doc.fields.rights">
      <label for="rights-value">Rights</label>
    </div>

    <div class="citation-field form-floating" id="section">
      <input type="text" class="form-control" id="section-value" name="section-value" aria-label="Section" placeholder="Section" v-model="formData.doc.fields.section">
      <label for="section-value">Section</label>
    </div>

    <div class="citation-field form-floating" id="series">
      <input type="text" class="form-control" id="series-value" name="series-value" aria-label="Series" placeholder="Series" v-model="formData.doc.fields.series">
      <label for="series-value">Series</label>
    </div>

    <div class="citation-field form-floating" id="seriesNumber">
      <input type="text" class="form-control" id="seriesNumber-value" name="seriesNumber-value" aria-label="Series Number" placeholder="Series Number" v-model="formData.doc.fields.seriesNumber">
      <label for="seriesNumber-value">Series Number</label>
    </div>

    <div class="citation-field form-floating" id="shortTitle">
      <input type="text" class="form-control" id="shortTitle-value" name="shortTitle-value" aria-label="Short Title" placeholder="Short Title" v-model="formData.doc.fields.shortTitle">
      <label for="shortTitle-value">Short Title</label>
    </div>

    <div class="citation-field form-floating" id="title">
      <input type="text" class="form-control" id="title-value" name="title-value" aria-label="Title" placeholder="Title" v-model="formData.doc.fields.title">
      <label for="title-value">Title</label>
    </div>

    <div class="citation-field form-floating" id="url">
      <input type="text" class="form-control" id="url-value" name="url-value" aria-label="URL" placeholder="Full website link (URL)" v-model="formData.doc.fields.url">
      <label for="url-value">URL</label>
    </div>

  </div>

  <div class="form-floating">
      <textarea class="form-control" placeholder="Enter notes here..." id="formInputDISAAcknowledgements" style="height: 128px"></textarea>
      <label for="formInputDISAAcknowledgements">Acknowledgements</label>
  </div>

  <div class="form-floating">
      <textarea class="form-control" placeholder="Enter notes here..." id="formInputDISABiblioResearcherNotes" style="height: 128px"></textarea>
      <label for="formInputDISABiblioResearcherNotes">Researcher notes</label>
      <a href="#" style="font-size:80%;font-weight:bold;clear:left;">Report problems or ask for help</a>
  </div>

  <a type="button" class="btn btn-primary btn-md" href="../../redesign_citations/">
    &nwarr; save source and exit
  </a>

  <button type="submit" class="btn btn-primary btn-md" id="citation-form-submit"
          v-on:click="openItemTab">
    save source and continue to enter items &rarr;
  </button>


  </form>
    </div> <!-- /.tab-pane for bibinfo -->

    <!-- Item Tab -->

    <div class="tab-pane card-body"
         role="tabpanel" aria-labelledby="item-tab" id="Items">
    
      <!-- "Save status" indicator -->

      <disa-save-status ref="database"></disa-save-status>

      <!-- "Change item" modal -->
      
      <div class="modal" tabindex="-1" id="item-selector-modal">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">
                Select an item to edit
              </h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <ul class="list-group">
                <li class="list-group-item d-flex justify-content-between align-items-start"
                    data-bs-dismiss="modal"
                    v-for="item in formData.doc.references"
                    v-on:click="currentItemId = item.id">
                  <div class="ms-2 me-auto"
                       v-text="makeItemDisplayTitle(item, 50)">
                  </div>
                  <disa-id v-bind:forthis="currentItem" class="float-end"></disa-id>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      
      <div class="tab-content" style="background-color: white!important;opacity:1;">

        <div class="active tab-pane" role="tabpanel" aria-labelledby="New-Item"
             id="New-Item">

          <!-- Top control panel: title, item selector, and new item button -->

          <div class="card bg-light">
            <div class="card-body">

              <!-- Main title -->

              <disa-id v-bind:forthis="currentItem" class="float-end"></disa-id>
              <h1 v-text="makeItemDisplayTitle(currentItem)"></h1>
              <div class="float-end">

                <!-- Change item button 
                      (opens modal #item-selector-modal, defined above) -->

                <button type="button" class="btn btn-primary btn-sm"
                        data-bs-toggle="modal" data-bs-target="#item-selector-modal">
                  open another item
                </button>

                <!-- Create new item control -->

                <button type="button" class="btn btn-primary btn-sm"
                        v-on:click="makeNewItem">
                  create a new item
                </button>
              </div>
            </div>
          </div>

          <!-- Main item input form -->

          <div id="item-form">
            <form>
              <div class="row col-lg-12" style="padding-top:40px;padding-left:25px;">
                <div class="col-md-6">
                  <h5 class="text-dark" style="float:left;">
                    Item's location in source document
                  </h5>
                  <!-- Item page numbers -->

                  <div class="form-floating">
                    <input type="number" class="form-control"
                           id="formInputDISAItemVolume" aria-label="Volume"
                           placeholder="Volume in source" v-model="currentItem.volume">
                    <label for="formInputDISAItemVolume">Volume</label>
                  </div>
                  <div class="form-floating">
                    <div class="input-group mb-3">
                      <span class="input-group-text">Page numbers from</span>
                      <input type="number"
                             class="form-control" id="formInputDISASourcePageStart"
                             aria-label="starting page number"
                             v-model="currentItem.page_start"
                             placeholder="starting page">
                      <span class="input-group-text">to</span>
                      <input type="number"
                             class="form-control" id="formInputDISASourcePageEnd" aria-label="ending page number"
                             placeholder="ending page" v-model="currentItem.page_end">
                    </div>
                  </div>
                </div>
                
                <!-- Item type and transcription area-->
                <div class="col-md-6">
                  <h5 class="text-dark">Item content</h5>
                  <div class="form-floating">
                    <select class="form-select"
                            id="formInputDISAItemType"
                            aria-label=""
                            v-model="currentItem.reference_type_id">
                      <option v-for="(itemTypeOption, itemTypeOptionId) in MENU_OPTIONS.formInputDISAItemType"
                              v-bind:value="itemTypeOptionId"
                              v-text="itemTypeOption"></option>
                    </select>
                    <label for="formInputDISAItemType">Item type</label>
                  </div>
                  <div class="form-floating">
                    <textarea class="form-control"
                              placeholder="Transcription"
                              id="formInputDISAItemTranscription"
                              style="height: 128px"
                              v-model="currentItem.transcription"></textarea>
                    <label for="formInputDISAItemTranscription">Transcription</label>
                    <a href="#" style="font-size:80%;font-weight:bold;clear:left;">Open in new window</a> </div>
                </div>
              </div> <!-- /.row -->
              <hr>  
              <!-- Item date and location -->
              <div class="row" style="padding:25px;">
                <!-- Item date -->
                <div class="col-md-6">
                  <h5 class="text-dark">Event date</h5>

                  <div class="input-group mb-3"> <!--
                    <span class="input-group-text" id="basic-addon1">@</span>
                    <input type="text" class="form-control" placeholder="Username" aria-label="Username" aria-describedby="basic-addon1">
                    -->
                    <select class="form-select" id="formInputDISAEventDateMonth"
                            aria-label="Event date: month" placeholder="Month"
                            vv-model="currentItemDate_month"
                            v-model="currentItem.dateParts.month">
                      <option value="-1">Month unspecified</option>
                      <option value="1">January</option>
                      <option value="2">February</option>
                      <option value="3">March</option>
                      <option value="4">April</option>
                      <option value="5">May</option>
                      <option value="6">June</option>
                      <option value="7">July</option>
                      <option value="8">August</option>
                      <option value="9">September</option>
                      <option value="10">October</option>
                      <option value="11">November</option>
                      <option value="12">December</option>
                    </select>
                    <input class="form-control" id="formInputDISAEventDateDay"
                            type="number" min="0" max="31" placeholder="Day"
                            vv-model="currentItemDate_day"
                            v-model="currentItem.dateParts.day">
                    <input class="form-control" id="formInputDISAEventDateYear"
                            type="number" min="1500" max="1900" placeholder="Year"
                            vv-model="currentItemDate_year"
                            v-model="currentItem.dateParts.year">
                  </div>

                  <!-- AWAITING NEW DATA MODEL
                  <div class="form-floating">
                    <input type="text" class="form-control" id="formInputDISAEventDateInfo" aria-label="Additional date information" placeholder="Additional date info.">
                    <label for="formInputDISAEventDateInfo">Additional date info.</label>
                  </div> -->

                </div>
                <!-- Item location -->
                <div class="col-md-6">
                  <h5 class="text-dark">Place</h5>
                  <div class="form-floating">
                    <select class="form-select" id="formInputDISAColonialContext" aria-label="Colonial context"
                            v-model="currentItem.national_context_id">
                      <option v-for="(colonialContextOption, colonialContextOptionId) in MENU_OPTIONS.formInputDISAColonialContext"
                              v-bind:value="colonialContextOptionId"
                              v-text="colonialContextOption">
                    </select>
                    <label for="formInputDISAColonialContext">Colonial context</label>
                  </div>
                  <div class="form-floating">
                    <input type="text" class="form-control" id="formInputDISAColonyState" 
                           aria-label="Colony / State" placeholder="Colony / State"
                           v-model="currentItemLocationColonyState">
                    <label for="formInputDISAColonyState">Colony / State</label>
                  </div>
                  <div class="form-floating">
                    <input type="text" class="form-control" id="formInputDISATown" 
                           aria-label="Town" placeholder="Town"
                           v-model="currentItemLocationCity">
                    <label for="formInputDISATown">Town</label>
                  </div>
                  <div class="form-floating">
                    <input type="text" class="form-control" id="formInputDISAPlaceInfo" 
                           aria-label="Additional location information" placeholder="Additional location info."
                           v-model="currentItemLocationLocale">
                    <label for="formInputDISAPlaceInfo">Additional location info.</label>
                  </div>
                </div>
              </div>
              <hr>

              <!-- Referents (people) -->
              
              <div class="row" style="padding-top:20px;padding-right:20px;">
                <div class="col-md-12" style="margin-left: 40px;">

                  <!-- Add new referent button -->

                  <h5 class="text-dark" style="float:left;">People
                    <button class="btn btn-link btn-sm"
                            v-on:click="makeNewReferent"
                            title="Enter information for a new person">
                      +new
                    </button>
                  </h5>
                  <div class="col-lg-12" style="padding-right: 40px; clear: both">
                    <div class="card"
                         v-for="(referent, referentId) in currentItem.referents">

                      <!-- Main (clickable accordion) header for this referent -->

                      <div class="card-header"
                            v-on:click="currentReferentId = (currentReferentId === referent.id) ? -1 : referent.id">
                        <span v-text="getReferentDisplayLabel(referent)"></span>
                        <disa-id v-bind:forthis="referent" class="float-end"></disa-id>
                      </div>

                      <!-- Edit area for this referent -->

                      <div class="card-body"
                           v-if="currentReferentId === referent.id">
                        <div class="card card-body">

                          <!-- Name(s) -->

                          <!-- Heading and create-new-name button -->
                          
                          <div>
                            <strong v-text="'Name' + (referent.names && referent.names.length > 1 ? 's' : '')"></strong>
                            <button type="button" class="btn btn-link btn-sm" id="formInputDISAPersonAddName"
                                    v-on:click="makeNewReferentName"
                                    title="Enter new name for this person">
                              +new
                            </button>
                          </div>

                          <!-- List of names -->

                          <ul>
                            <li v-for="(name, nameIndex) in referent.names">

                              <div v-on:click="currentNameId = (currentNameId === name.id) ? -1 : name.id">
                                <span v-if="name.first || name.last">
                                  <span v-text="`${name.first} ${name.last}  `"></span>
                                  <disa-id v-if="currentNameId === name.id" v-bind:forthis="name"></disa-id>
                                </span>
                                <em v-else>
                                  New name
                                </em>
                              </div>

                              <!-- Current name - details -->

                              <div v-if="currentNameId === name.id">

                                <!-- ADVANCED NAMES - DEFER FOR NEW MODEL
                                <div class="custom-control custom-switch" style="">
                                  <input type="checkbox" class="custom-control-input" id="formCustomSwitchForAdvancedNames"
                                          v-model="referent.name">
                                  <label style="font-size: 85%;margin-top: -10px;font-weight:bold;"
                                          class="custom-control-label" for="formCustomSwitchForAdvancedNames">
                                    ADVANCED NAME OPTIONS (if the first / last name designation doesn't apply)
                                  </label>
                                </div> -->

                                <div class="form-floating">
                                  <select class="form-select" id="formInputDISAItemPersonNameType" 
                                          aria-label="Name type"
                                          v-model="name.name_type">
                                    <option v-for="(nameTypeMenuLabel, nameTypeId) in MENU_OPTIONS.formInputDISAItemPersonNameType"
                                            v-bind:value="nameTypeId"
                                            v-text="nameTypeMenuLabel">
                                    </option>
                                  </select>
                                  <label for="formInputDISAItemPersonNameType">Name type</label>
                                </div>
                                <!-- NAME TRANSCRIPTION - DEFER TO V2? OR DROP?
                                <div class="form-floating">
                                  <input type="text"
                                          class="form-control" id="formInputDISAItemPersonNameTranscription"
                                          aria-label="Full name transcription"
                                          placeholder="The name as it's written in the document"
                                          v-model="referent.transcription">
                                  <label for="formInputDISAItemPersonNameTranscription">Full name transcription</label>
                                </div> -->
                                <div class="form-floating">
                                  <input type="text" class="form-control" id="formInputDISAItemPersonFirstName"
                                          aria-label="First name" placeholder="First name"
                                          v-model="name.first">
                                  <label for="formInputDISAItemPersonFirstName">First name</label>
                                </div>
                                <div class="form-floating">
                                  <input type="text" class="form-control" id="formInputDISAItemPersonLastName"
                                          aria-label="Last name" placeholder="Last name"
                                          v-model="name.last">
                                  <label for="formInputDISAItemPersonLastName">Last name</label>
                                </div>
                              </div>
                            </li>
                          </ul>
                        </div>
                        
                        <div class="row" style="padding-top:10px;clear: both;">
                          <div class="col-md-6">

                            <!-- Gender -->

                            <div class="form-floating">
                              <select class="form-select" id="formInputDISAPersonGender"
                                      aria-label="New person's gender" placeholder="Gender"
                                      v-model="referent.sex">
                                <option v-for="(genderOption, genderOptionId) in MENU_OPTIONS.formInputDISAPersonGender"
                                        v-bind:value="genderOptionId"
                                        v-text="genderOption">
                              </select>
                              <label for="formInputDISAPersonGender">Gender</label>
                            </div>

                            <!-- Age -->

                            <div class="form-group">
                              <div class="form-floating"> <!--
                                <input v-model="referent.age" id="formInputDISAPersonAge"></input>
                                <label for="formInputDISAPersonAge">Age</label> -->

                                <!-- BELOW IS FOR NEW MODEL WITH AGE AS NUMBER OR TEXT -->
                                <!--
                                <input vv-if="TEST FOR age_number"
                                        type="number" min="0" max="110"> -->
                                <select class="form-select" id="formInputDISAPersonAge_number" 
                                        aria-label="New person's age (number)" 
                                        placeholder="New person's age (number)">
                                  <option selected>&nbsp;</option>
                                  <option value="-1">Unspecified</option>
                                  <option value="1">1 year</option>
                                  <option value="2">2 years</option>
                                  <option value="3">3 years</option>
                                </select>
                                <label for="formInputDISAPersonAge_number">Age</label>
                                <input type="text" class="form-control" id="formInputDISAPersonAge_text" 
                                       aria-label="New person's age (text)" placeholder="New person's age (text)"
                                       v-model="referent.age">
                                <!-- WAITING FOR NEW MODEL
                                <div class="form-check" style="margin-top:-6px;">
                                  <input class="form-check-input" style="margin-left:.125em;" type="checkbox" id="formInputSpecifiedByNumber" value="option1">
                                  <label class="form-check-label" style="font-size: 85%;font-weight:bold;margin-left:.5em;margin-top:-10px;" 
                                         for="formInputSpecifiedByNumber">
                                    AGE SPECIFIED BY A NUMBER
                                  </label>
                                </div>-->
                              </div>
                            </div>

                            <!-- Status -->

                            <div class="form-floating-x" style="clear: both">
                                <label for="formInputDISAPersonStatus">Status</label>
                                <!--
                                <disa-tags v-bind:value="referent.status"
                                           v-bind:suggestions="MENU_OPTIONS.formInputDISAPersonStatus"
                                           id="formInputDISAPersonStatus"></disa-tags> -->
                              <!--
                              <input class="form-select taggedInput" id="formInputDISAPersonStatus" aria-label="New person's status"
                                      value="yes1, yes2, yes3"
                                      placeholder="Status">
                                </input>-->
                            </div>
                            <div class="form-floating">
                              <input type="text" class="form-control" id="formInputDISAStatusInfo" aria-label="Additional status information" placeholder="Additional status info.">
                              <label for="formInputDISAStatusInfo">Additional status info.</label>
                            </div>

                            <!-- Vocation -->

                            <div class="form-floating">
                              <select class="form-select" id="formInputDISAPersonVocation" aria-label="Vocation" placeholder="Vocation">
                                <option v-for="(vocationOption, vocationOptionId) in MENU_OPTIONS.formInputDISAPersonVocation"
                                        v-bind:value="vocationOptionId"
                                        v-text="vocationOption">
                                </option>
                              </select>
                              <label for="formInputDISAPersonVocation">Vocation</label>
                            </div>
                          </div>
                          <div class="col-md-6">

                            <!-- Race -->

                            <div class="form-floating">
                              <select class="form-select" id="formInputDISAPersonRace" 
                                      aria-label="This person's race designation"
                                      v-model="currentReferentRaceID">
                                  <option v-for="(raceOption, raceOptionId) in MENU_OPTIONS.formInputDISAPersonRace"
                                          v-bind:value="raceOptionId"
                                          v-text="raceOption"></option>
                              </select>
                              <label for="formInputDISAPersonRace">Race</label>
                            </div>
                            <div class="form-floating">
                              <input type="text" class="form-control" id="formInputDISAPersonRaceTerms" 
                                     aria-label="Exact racial terms used" placeholder="Exact racial terms used">
                              <label for="formInputDISAPersonRaceTerms">Exact racial terms used</label>
                            </div>

                            <!-- Tribe -->

                            <div class="form-floating-x">
                              <label for="formInputDISAPersonTribe">Tribe</label>
                              <disa-tags v-model="currentReferentTribesForTagify"
                                         v-bind:suggestions="MENU_OPTIONS.formInputDISAPersonTribe"
                                         id="formInputDISAPersonTribe"></disa-tags>
                            </div>
                            <div class="form-floating">
                              <input type="text" class="form-control" id="formInputDISAPersonTribeTerms" aria-label="Exact identity/geographical terms used" placeholder="Exact identity/geographical terms used">
                              <label for="formInputDISAPersonTribeTerms">Exact identity/geographical terms used</label>
                            </div>

                            <!-- Geographical origins -->

                            <div class="form-floating">
                              <input type="text" class="form-control" id="formInputDISAPersonGeoOrigins" aria-label="Geographic origins" placeholder="Geographic origins">
                              <label for="formInputDISAPersonGeoOrigins">Geographic origins</label>
                            </div>
                          </div>
                        </div>
                        <div class="card card-body" style-x="padding-top:10px;clear: both;">

                          <!-- Relationships -->
<!--
                          <div class="card card-body">
                            HELLO
                          </div> -->

                          <div>
                            <strong>Relationships</strong>
                            <button class="btn btn-link btn-sm"
                                    v-on:click=""
                                    title="Enter information for a new relationship">
                              +new
                            </button>
                          </div>

                          <div class="row"
                               v-if="referent.relationships"
                               v-for="relationship in referent.relationships">

                            <!-- Subject of relationship (i.e. the current referent) -->

                            <div class="col-md-3" style="text-align: left">
                              <span v-text="getReferentDisplayLabel(referent)"></span> was
                            </div>

                            <!-- Relationship type -->

                            <div class="col-md-4">
                              <select class="form-select" id="formInputDISARelationship" 
                                      aria-label="Type of relationship"
                                      v-model="relationship.rel.id">
                                <option v-for="(relationshipTypeOption, relationshipTypeId) in MENU_OPTIONS.formInputDISARelationship"
                                        v-bind:value="relationshipTypeId"
                                        v-text="relationshipTypeOption"></option>
                              </select>
                            </div>

                            <!-- Object of relationship (only show dropdown if there are more than 2 referents) -->

                            <div v-if="Object.keys(currentItem.referents).length > 2"
                                 class="col-md-4">
                                 
                              <select class="form-select" id="formInputDISARelationshipObject" 
                                      aria-label="Who is in the relationship"
                                      v-model="relationship.obj.id">
                                <option v-for="(relationshipObject, relationshipObjectId) in currentItem.referents"
                                        v-if="relationshipObjectId != referent.id"
                                        v-bind:value="relationshipObjectId"
                                        v-text="getReferentDisplayLabel(relationshipObject)">
                                </option>
                              </select>
                            </div>
                            <div v-else class="col-md-4" 
                                 v-text="getReferentDisplayLabel(Object.values(currentItem.referents).find(r => r !== currentReferent))">
                            </div>
                            <div class="col">
                              <button title="Delete this relationship" class="btn btn-link btn-sm">
                                &times;delete
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>    
                    </div>
                  </div>
                </div>
              </div>
              <!-- Item notes -->
              <!-- 
              <hr />
              <h5>Notes</h5> 
              -->
              <div class="col-lg-12" style="padding-top:20px;padding-left:40px;padding-right:40px;padding-bottom:40px;">

                <!-- RESEARCHER NOTES ARE FOR NEW MODEL
                <div class="form-floating">
                  <textarea class="form-control" placeholder="Enter notes here..." id="formInputDISAPeopleResearcherNotes" style="height: 128px"></textarea>
                  <label for="formInputDISAPeopleResearcherNotes">Researcher notes</label>
                  <a href="#" style="font-size:80%;font-weight:bold;clear:left;">Report problems or ask for help</a> 
                </div>-->

                <!-- IS THIS BUTTON NECESSARY? 
                <button type="button" class="btn btn-secondary btn-md" style="font-weight: bold;margin-top: 20px;">
                  ALL CHANGES SAVED
                </button> 
                -->
                <a type="button" class="btn btn-primary btn-md" href="../../redesign_citations/">
                  &nwarr; save item and exit this source
                </a>
              </div>
            </form>
          </div>
        </div> <!-- /.tab-pane for items -->
      </div> <!-- /.tab-content for items -->
    <!-- </div> -->

    </div>
  </div>
</div> <!-- /#tabs_bibinfoanditems -->

{% endblock content %}


{% block page_specific_js %}


{% endblock page_specific_js %}
